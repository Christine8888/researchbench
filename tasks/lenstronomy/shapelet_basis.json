{
  "task_id": "shapelet_basis_validation",
  "kind": "numeric",
  "difficulty": 4,
  "description": "Validate the orthonormality of shapelet basis functions in lenstronomy, which are critical for accurate source reconstruction.",
  "instructions": "1. Initialize the Shapelet class: Create an instance of `lenstronomy.LightModel.Profiles.shapelets.ShapeletSet` with parameters n_max = 5 (maximum polynomial order) and beta = 0.05 arcsec (shapelet scale parameter).\n2. Create a grid: Define a 2D coordinate grid spanning [-0.5, 0.5] arcsec in both x and y directions with a resolution of 0.01 arcsec/pixel (resulting in a 100×100 pixel grid). Center the grid at (0,0).\n3. Generate basis functions: Use the `function` method of the ShapeletSet class to evaluate two different shapelet basis functions on this grid. Select basis functions with indices n₁ = 2, m₁ = 0 (nx=2, ny=0) and n₂ = 0, m₂ = 2 (nx=0, ny=2). These would be Hermite polynomials of different orders as described in Birrer et al. (2015).\n4. Test orthogonality: Calculate the numerical integral of the product of these two basis functions over the grid. This can be done by multiplying the two function values at each pixel and summing, then multiplying by the pixel area (0.01² = 0.0001 arcsec²).\n5. Report the absolute value of this integral. According to the theory of shapelet basis functions described in the paper, different basis functions should be orthogonal, meaning their inner product should be zero.\n6. As a verification, also calculate the integral of a basis function with itself (e.g., n=2, m=0 with itself), which should give a value of 1.0 due to the normalization of shapelets.",
  "expected_output": 0.0,
  "tolerance": 1e-4,
  "parents": [],
  "paper_id": "lenstronomy",
  "output_justification": "The expected output of 0.0 comes from the mathematical property of orthogonality of the shapelet basis functions. As described in Birrer et al. (2015) 'Gravitational lens modeling with basis sets', shapelets form an orthonormal basis set, meaning different basis functions should have zero inner product. This is a mathematical requirement for the shapelet decomposition method to work correctly in source reconstruction, which is highlighted as a key feature of lenstronomy in the paper."
}