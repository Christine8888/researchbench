{
    "task_id": "gw_1",
    "paper_id": "2202.05164",
    "description": "hierarchical Bayesian model for gravitational wave NSBH populations",
    "publication_date": "2022-04-09",
    "environment": "gw",
    "code_available": true,
    "eval_metrics": {
        "ns_max_mass": ["maximum non-spinning neutron star mass, assuming uniformly distributed NS spins up to breakup spin, measured using 4 LIGO events", 2.7]
    },
    "test_metrics": {},
    "additional_tasks": {
        "corner_plot": ["path to saved corner plot in (mu, sigma, M_TOV, M_BH, alpha, a_max/a_kep, beta_s", 0]
    },
    "tolerance": 1,
    "instructions": "\\begin{abstract}\nGravitational-wave (GW) detections of merging neutron star--black hole (NSBH) systems probe astrophysical neutron star (NS) and black hole (BH) mass distributions, especially at the transition between NS and BH masses. Of particular interest are the maximum NS mass, minimum BH mass, and potential mass gap between them. While previous GW population analyses assumed all NSs obey the same maximum mass, if rapidly spinning NSs exist, they can extend to larger maximum masses than nonspinning NSs. In fact, several authors have proposed that the $\\sim2.6\\,M_\\odot$ object in the event GW190814 -- either the most massive NS or least massive BH observed to date -- is a rapidly spinning NS. We therefore infer the NSBH mass distribution jointly with the NS spin distribution, modeling the NS maximum mass as a function of spin. Using 4 LIGO--Virgo NSBH events including GW190814, if we assume that the NS spin distribution is uniformly distributed up to the maximum (breakup) spin, we infer the maximum non-spinning NS mass is $2.7^{+0.5}_{-0.4}\\,M_\\odot$ (90\\% credibility), while assuming only nonspinning NSs, the NS maximum mass must be $>2.53 M_\\odot$ (90\\% credibility). The data support the mass gap's existence, with a minimum BH mass at $5.4^{+0.7}_{-1.0} M_\\odot$. With future observations, under simplified assumptions, 150 NSBH events may constrain the maximum nonspinning NS mass to $\\pm0.02\\,M_\\odot$, and we may even measure the relation between the NS spin and maximum mass entirely from GW data. If rapidly rotating NSs exist, their spins and masses must be modeled simultaneously to avoid biasing the NS maximum mass.\n\n\\end{abstract}\n\n\\maketitle\n\\section{Introduction}\n\\label{sec:intro}\n\nThe transition between neutron star (NS) and black hole (BH) masses is key to our understanding of stellar evolution, supernova physics, and nuclear physics. In particular, the maximum mass that a NS can support before collapsing to a black hole (BH), known as the Tolman\u2013Oppenheimer\u2013Volkoff (TOV) mass $M_\\mathrm{TOV}$ for a nonspinning NS,  is governed by the unknown high-density nuclear EOS~\\citep{1996A&A...305..871B,1996ApJ...470L..61K,2012ARNPS..62..485L}.\nConstraints on the maximum NS mass can therefore inform the nuclear EOS, together with astrophysical observations such as X-ray timing of pulsar hotspots~\\citep{2019ApJ...887L..25B}, gravitational-wave (GW) tidal effects from mergers involving NSs~\\citep{2018PhRvL.121p1101A,2019EPJA...55..209L,2020PhRvD.101l3007L,2020Sci...370.1450D}, and electromagnetic observations of binary neutron star (BNS) merger remnants~\\citep{2017ApJ...850L..19M,2018ApJ...852L..25R}, as well as lab experiments~\\citep[e.g.][]{2021PhRvL.126q2502A}. Recent theoretical and observational constraints on the EOS have placed $M_\\mathrm{TOV} = 2.2$--$2.5\\,M_\\odot$~\\citep[e.g.][]{2021PhRvD.104f3003L}. If astrophysical NSs exist up to the maximum possible NS mass, $M_\\mathrm{TOV}$ can be measured by fitting the NS mass distribution to Galactic NS observations~\\citep{2011MNRAS.414.1427V,2012ApJ...757...55O,2018MNRAS.478.1377A,2019ApJ...876...18F,2020RNAAS...4...65F}. A recent fit to Galactic \\reply{neutron stars} finds a maximum mass of $2.22^{+0.85}_{-0.23}\\,M_\\odot$~\\citep{2020RNAAS...4...65F}. In particular, observations of massive pulsars~\\citep{2013Sci...340..448A,2020NatAs...4...72C} set a lower limit of $M_\\mathrm{TOV} \\gtrsim 2\\,M_\\odot$.\n\nMeanwhile, the minimum BH mass and the question of a mass gap between NSs and BHs is of importance to supernova physics~\\citep{2001ApJ...554..548F,2012ApJ...749...91F,2012ApJ...757...91B,2021ApJ...908..106L}. Observations of BHs in X-ray binaries first suggested a mass gap between the heaviest NSs (limited by $M_\\mathrm{TOV}$) and the lightest BHs ($\\sim5\\,M_\\odot$; \\citealt{2010ApJ...725.1918O,2011ApJ...741..103F}), although recent observations suggest that the mass gap may not be empty~\\citep{2019Sci...366..637T,2020ApJ...896L..44A}.\n\nOver the last few years, the GW observatories Advanced LIGO~\\citep{2015CQGra..32g4001L} and Virgo~\\citep{2015CQGra..32b4001A} have revealed a new astrophysical population of NSs and BHs in merging binary black holes (BBHs)~\\citep{2016PhRvL.116f1102A}, BNS~\\citep{2017PhRvL.119p1101A,2020ApJ...892L...3A}, neutron-star black hole (NSBH) systems~\\citep{2021ApJ...915L...5A}. These observations can be used to infer the NS mass distribution in merging binaries and constrain the maximum NS mass~\\citep{2020PhRvD.102f4063C,2021ApJ...909L..19G,2021arXiv210704559L,2021arXiv210806986L,2021arXiv211202605Z,2021arXiv211103634T}. Furthermore, jointly fitting the NS and BH mass distribution using GW data probes the existence of the mass gap~\\citep{2017MNRAS.465.3254M,2020ApJ...899L...8F,2021arXiv211103498F}. Recent fits of the BNS, BBH and NSBH mass spectrum finds a relative lack of objects between $2.6$--$6\\,M_\\odot$~\\citep{2021ApJ...913L...7A,2021arXiv211103498F,2021arXiv211103634T}.\n\nGravitational-wave NSBH detections can uniquely explore both the maximum NS mass and the minimum BH mass simultaneously with the same system. In particular, the NS and BH masses in the first NSBH detections~\\citep{2021ApJ...915L...5A} seem to straddle either side of the proposed mass gap~\\citep{2021arXiv211103498F}, especially when assuming astrophysically-motivated BH spins~\\citep{2021arXiv210914759M}. However, our understanding of the NS maximum mass and the mass gap from GWs is challenged by one discovery: GW190814~\\citep{2020ApJ...896L..44A}. The secondary mass of GW190814 is tightly measured at $2.6\\,M_\\odot$, making it exceptionally lighter than BHs in BBH systems~\\citep{2021arXiv210900418E} but heavier than most estimates of $M_\\mathrm{TOV}$~\\citep{2020ApJ...896L..44A,2020ApJ...904...80E}. As a possible explanation, several authors have proposed that GW190814 is a \\emph{spinning} NS~\\citep{2020MNRAS.499L..82M}. While $M_\\mathrm{TOV}$ limits the mass of nonspinning NSs, NSs with substantial spins can support $\\sim 20\\%$ more mass~\\citep{1994ApJ...424..823C}. Unfortunately, it is difficult to test the spinning NS hypothesis for a single system, because the spin of the secondary $2.6\\,M_\\odot$ object in GW190814 is virtually unconstrained from the GW signal.\n\nIn this paper, we show that by studying a \\emph{population} of NSBH events, we may measure the NS maximum mass as a function of spin. \\reply{We build upon the work of~\\citet{2021arXiv211202605Z,2021arXiv211103498F,2021arXiv211103634T}, who studied the population statistics of NSBH masses and BH spins, but allow the NS mass distribution to depend on NS spin for the first time.} This method will not only enable more accurate classifications for NSBH versus BBH events in cases like GW190814, but will also prevent biases that would result from measuring $M_\\mathrm{TOV}$ while neglecting the dependence of the maximum NS mass on spin. \\reply{As~\\citet{2022MNRAS.511.4350B} previously showed, mismodeling the NS spin distribution can bias the inferred mass distribution even in cases where the NS mass distribution does not vary with spin, simply because masses and spins are correlated in the GW parameter estimation of individual events.} The rest of this paper is structured as follows. Section \\ref{Methods} describes population-level spin and mass models, our hierarchical Bayesian framework, the current GW data, and our procedure for simulating future NSBH events. Results from analyzing the LIGO--Virgo NSBH mergers are presented in Section \\ref{ligodata}; results from simulating future GW NSBH observations are presented in Section \\ref{Projections}. We conclude in Section~\\ref{sec:conclusion}.\n\n\\section{Methods} \\label{Methods}\n\n\\subsection{Population Models} \\label{models}\nWe use the following phenomenological models to describe the astrophysical spin (Section~\\ref{spin models}) and mass (Section~\\ref{ns models}--\\ref{bh mass}) distribution of NSBH systems.\n\n\\subsubsection{Spin Models} \\label{spin models}\n\nIt remains unclear whether NSs, specifically those in merging BNS and NSBH systems, can have significant spins. The most rapidly spinning NS in a (nonmerging) double NS system is the Pulsar J1807-2500B with a period of 4.2 ms or dimensionless spin magnitude $a = 0.12$~\\citep{2012ApJ...745..109L}. Among recycled pulsars, the fastest spinning is Pulsar J1748-2446ad with a period of $\\sim1.4$ ms~\\citep{2006Sci...311.1901H}. However, rapidly spinning NSs in which spin down is inefficient (due to e.g. weak magnetic fields) may have avoided electromagnetic discovery for the same reasons. In NSBH systems, it may also be possible for the NS spin to grow through accretion if the NS is born before the BH~\\citep{2021MNRAS.504.3682C}, or through tidal synchronization as has been studied in BBH systems ~\\citep{2018A&A...616A..28Q}.\n\nWe remain agnostic about NS spin magnitudes, modeling their distribution as a power law,\n\\begin{equation}\n\\label{eq:NSspin}\n    p(a_2 | a_\\mathrm{max}, \\beta_{{s}}) \\propto  \\begin{cases}  \n      {(1-a_2)}^{\\beta_{s}} & 0 < a_2 < a_\\mathrm{max}\\\\\n      0 & \\text{otherwise},\n      \\end{cases}\n\\end{equation}\nwhere $a_\\mathrm{max}$ sets an upper limit on possible values of $a_2$ and $\\beta_s$ controls the slope. For $\\beta_s = 0$, the secondary spin magnitude follows a uniform distribution; for $\\beta_s > 0$, the secondary spin distribution prefers low spin. The maximum value of $a_\\mathrm{max}$ is the breakup spin $a_\\text{Kep}$, which is around $a_\\text{Kep} \\approx 0.7$ for most EOSs.\n\nWe do not explicitly model NS spin tilts (the angle between the spin vector and the orbital angular momentum axis), but consider a few different assumptions and explore how they affect our inference. By default, we consider a NS spin tilt distribution that is isotropic, or flat in $-1< \\cos(\\mathrm{tilt}_2) < 1$. We also explore a restricted model in which NS spins are perfectly aligned with the orbit, $\\cos(\\mathrm{tilt}_2) = 1$.\nFor the distribution of BH spins, by default we assume that BHs are nonspinning~\\citep[$a_1 = 0$;][]{2019ApJ...881L...1F,2021arXiv210914759M}. We alternatively assume that the BH spin distribution is uniform in spin magnitude with isotropic spin tilts.\n\nIn summary, we consider the following spin models:\n\\begin{enumerate}\n    \\item \\emph{Zero spin BH} (``ZS\", default spin model): Primary BH is nonspinning ($a_1  = 0$). Secondary NS spin is isotropic in spin tilt (flat in $-1 < \\cos(\\mathrm{tilt}_2) < 1$) and follows a power law in the spin magnitude $a_2$ (Eq.~\\ref{eq:NSspin}).\n\n    \\item \\emph{Zero spin BH + aligned spin NS} (``ZS + AS\"): \n    Same as \\emph{Default}, but with $\\cos(\\mathrm{tilt}_2) = 1$.\n\n    \\item \\emph{Uniform and isotropic} (``U+I\"): Same as \\emph{Default}, but primary BH spin is flat in magnitude $a_1$ and $\\cos(\\mathrm{tilt}_1)$ rather than nonspinning.\n\n\\end{enumerate} \n\n\\subsubsection{NS Mass Models} \\label{ns models}\n\nLike the case with spins, we consider a few different mass models to check the robustness of our conclusions. We consider three models for NS masses, which describe the distribution of NSBH secondary masses $m_2$ (see Fig.~\\ref{fig:distributions}):\n\\begin{enumerate}\n    \\item \\emph{Default}: Single Gaussian distribution (panels a, d--f of Figure \\ref{fig:distributions})\n    \\begin{multline*}\n    p(m_2 | \\mu, \\sigma, M_{min}, M_{max}) = \\\\ \\begin{cases}  \n      \\mathcal{N}_T(m_2 | \\mu, \\sigma) & M_{min} \\leq m_2 \\leq M_{max} \\\\\n      0 & \\mathrm{otherwise},\n      \\end{cases}\n    \\end{multline*}\n    where $\\mathcal{N}_T(x \\mid \\mu, \\sigma)$ denotes a truncated Gaussian distribution with mean $\\mu$ and standard deviation $\\sigma$.\n\n    \\item Two-component (bimodal) Gaussian distribution (``2C\"), as in the Galactic NS distribution~\\citep[][panel b of Figure\\ref{fig:distributions}]{2018MNRAS.478.1377A} \n    \\begin{multline}\n    p(m_2 | \\mathcal{A}, \\mu_1, \\sigma_1, \\mu_2, \\sigma_2, M_\\mathrm{min}, M_\\mathrm{max}) = \\\\\n    \\begin{cases}  \n       \\mathcal{A}\\mathcal{N}_T(m_2 | \\mu_1, \\sigma_1) + \\\\ (1- \\mathcal{A})\\mathcal{N}_T(m_2 | \\mu_2, \\sigma_2) & M_\\mathrm{min} \\leq m_2 \\leq M_\\mathrm{max} \\\\\n       0 & \\mathrm{otherwise}.\n      \\end{cases}\n    \\end{multline}\n\n        \\item Uniform distribution (``U\") with sharp cutoffs at the minimum and maximum NS mass [$M_{\\rm min}, M_{\\rm max}$] (panel c of Figure~\\ref{fig:distributions}) \n    \\begin{multline*}\n    p(m_2 | M_\\mathrm{min}, M_\\mathrm{max}) = \\\\\n    \\begin{cases}  \n      \\frac{1}{M_\\mathrm{max} - M_\\mathrm{min}}  & M_\\mathrm{min} \\leq m_2 \\leq M_{\\rm max} \\\\\n      0 & \\mathrm{otherwise}.\n      \\end{cases}\n    \\end{multline*}\n\\end{enumerate}\nAll normal distributions ($\\mathcal{N}_T$) are truncated sharply and normalized to integrate to 1 between $M_\\text{min} = 1 M_\\odot$ and $M_\\text{max}$. In this work, we focus on inferring the maximum NS mass. While the minimum NS mass can also be inferred with GWs~\\citep{2020PhRvD.102f4063C}, we fix the minimum NS mass to $1\\,M_\\odot$ in our models. If binary stellar evolution can produce NSs with extreme masses, then $M_\\mathrm{min}$ and $M_\\mathrm{max}$ correspond to the minimum and maximum \\emph{allowable} masses set by nuclear physics.  \n\nCrucially, we allow NSs to have significant spin. Rapid uniform rotation may provide additional support to the NS, allowing it to reach masses greater than the non-spinning maximum mass $M_{TOV}$. \nWe model the dependence of $M_\\mathrm{max}$ on NS spin $a_2$ using the universal relationship from \\citet{2020MNRAS.499L..82M}:\n\\begin{multline*} \n    M_{\\text{max}}(a_2, a_{\\text{Kep}}, M_{\\text{TOV}}) = \\\\\n    M_{\\text{TOV}}\\left(1 + A_2\\left(\\frac{a_2}{a_{\\text{Kep}}}\\right)^2+A_4\\left(\\frac{a_2}{a_{\\text{Kep}}}\\right)^4\\right)\n\\end{multline*}\nwith $A_2 = 0.132$, $A_4 = 0.0071$, where $a_{\\text{Kep}}$ corresponds to the dimensionless spin at the mass-shedding limit. For concreteness, we assume $a_{\\mathrm{Kep}} = 0.7$, which is true for most EOS. For a neutron star with spin $a_{\\text{Kep}}$, the maximum possible mass is around $1.2\\times$ the (non-spinning) TOV limit. To measure this relation directly from gravitational-wave data, we also optionally measure a free, linear dependence between maximum spin and critical mass (see Section \\ref{sec:spinmass}):\n\n\\begin{equation}\n    M_{\\text{max}}(a_2, a_{\\text{Kep}}, M_{\\text{TOV}}) = M_{\\text{TOV}} A_1\\left(\\frac{a_2}{a_{\\text{Kep}}}\\right)\n\\end{equation}\n\nThe extent to which the NS mass distribution can extend above $M_\\text{TOV}$ depends on the spin distribution. \nThe NS mass distributions $p(m_2)$ above include a dependence on spin, and can be written as $p(m_2 | M_{\\rm max}(a_2), \\theta)$ where $\\theta$ includes all other parameters.\nFigure \\ref{fig:distributions}d--f shows the NS mass distribution under three variations of the spin distributions outlined in \\ref{spin models}.\n\n\\subsubsection{BH Mass Models and Pairings}\n\\label{bh mass}\nWe model the primary (BH) mass distribution $p(m_1)$ as a power law with slope $-\\alpha$, and a minimum mass cutoff at $M_{\\rm BH}$:\n\\begin{equation}\n\\label{eq:pm1}\np(m_1 | \\alpha, M_{\\rm BH}) \\propto  \\begin{cases}  \n      0 & x < M_{\\rm BH}\\\\\n      {m_1}^{-\\alpha} & \\text{otherwise}.\n      \\end{cases}\n\\end{equation}\nWe fix $\\alpha > 0$ such that the probability density decreases for increasing BH mass. The minimum BH mass represents the upper boundary of the mass gap. In order to restrict the range of $m_1$ to reasonable values, we optionally include a maximum BH mass of $30\\,M_\\odot$  in Eq.~\\ref{eq:pm1}. However, for most of our NSBH models, high-mass BHs are rare due to a relatively steep slope $\\alpha$ and/or a pairing function that disfavors extreme mass ratio pairings, and we do not explicitly model the BH maximum mass.\n\nWe assume that the pairing function between $m_1$ and $m_2$ NSBH systems follows a power law in the mass ratio $m_2/m_1 = q < 1$~\\citep{2020ApJ...891L..27F}:\n\\begin{equation}\n    p(q) \\propto q^{\\beta},\n\\end{equation}\nwhere by default we assume $\\beta =0$~\\citep{2021arXiv211103498F}. We alternatively consider the case $\\beta = 3$, which favors equal-mass pairings. Depending on the width of the mass gap, NSBHs may necessarily have unequal masses, but on a population level, higher $q$ may still be relatively preferred.\n\nPutting the mass and spin distributions together, we model the distribution of NSBH masses and spins $\\theta \\equiv (m_1, m_2, a_1, a_2)$ given population hyperparameters $\\Lambda$ and model $H$ as:\n\n\\begin{equation}\n    \\label{eq:fullpopmodel}\n    \\begin{split}\n    \\pi(\\theta | \\Lambda, H) \\propto p(m_1 \\mid \\alpha, M_\\mathrm{BH}, H)p(m_2 | \\Lambda_\\mathrm{NS}, a_2, H) \\\\\n    p(a_1 \\mid H)     p(a_2 | a_\\mathrm{max}, \\beta_s, H)p(q \\mid \\beta, H),\n    \\end{split}\n\\end{equation}\nwhere $H$ refers to the choice of model as described in the earlier subsections. For the extrinsic source parameters not in $\\theta$, we assume isotropic distributions in sky position, inclination and orientation, and the local-Universe approximation to a uniform-in-volume distribution $p(d_L) \\propto d_L^2$, where $d_L$ is the luminosity distance.\n\n\\subsection{Hierarchical Inference}\n\\subsubsection{Likelihood}\nWe infer properties of the overall NSBH population with a hierarchical Bayesian approach~\\citep{2004AIPC..735..195L,2019MNRAS.486.1086M}. This allows us to marginalize over the uncertainties in individual events' masses and spins (grouped together in the set $\\theta_i$ for event $i$) in order to estimate the hyperparameters $\\Lambda$ describing the NS and BH mass and spin distributions. For $N_{det}$ GW detections producing data $d$, the likelihood of the data is described by an inhomogeneous Poisson process:\n\n\\begin{equation}\n    \\mathcal{L}({d}|\\Lambda, N) = N^{N_{\\text{det}}} e^{-N\\xi(\\Lambda)}\\prod_{i=1}^{N_{\\text{det}}} \\int \\mathcal{L}({d_i}|\\theta_i)\\pi(\\theta_i|\\Lambda)\\:d\\theta_i\n\\end{equation}\nwhere $N$ is the total number of NSBH mergers in the Universe within some observing time, $\\xi(\\Lambda)$ is the fraction of detectable events in the population described by hyperparameters $\\Lambda$ (see Section~\\ref{sec:selection}), $\\mathcal{L}({d_i|\\theta_i})$ is the likelihood for event $i$ given its masses and spins $\\theta_i$, and $\\pi(\\theta|\\Lambda)$ describes the NSBH mass and spin distribution given population hyperparameters $\\Lambda$ (Eq.~\\ref{eq:fullpopmodel}. As we do not attempt to calculate event rates, we marginalize over $N$ with a log-uniform prior and calculate the population likelihood as~\\citep{2019MNRAS.486.1086M,2018ApJ...863L..41F}:\n\\begin{equation}\n    \\mathcal{L}({d}|\\Lambda) \\propto \\prod_{i=1}^{N_{\\text{det}}} \\frac{\\int \\mathcal{L}({d_i}|\\theta_i)\\pi(\\theta_i|\\Lambda)\\:d\\theta_i}{\\xi(\\Lambda)}\n\\end{equation}\nWe evaluate the single-event likelihood $\\mathcal{L}(d \\mid \\theta)$ via importance sampling over $N_\\text{samp}$ parameter estimation samples $\\theta_\\mathrm{PE}$ for each event:\n\\begin{equation}\n    \\int \\mathcal{L}({d}|\\theta)\\pi(\\theta|\\Lambda)\\:d\\theta \\simeq \\frac{1}{N_\\text{samp}} \\sum_{j=1}^{N_\\text{samp}} \\frac{\\pi(\\theta_{\\mathrm{PE},j}|\\Lambda)}{\\pi_{\\mathrm{PE}}(\\theta_{\\mathrm{PE},j})},\n\\end{equation}\nwhere $\\pi_\\mathrm{PE}(\\theta)$ is the original prior that was used in LIGO parameter estimation.\nWe calculate the posterior on the population parameters, $p(\\Lambda \\mid d)$, from the likelihood $\\mathcal{L}(d \\mid \\Lambda)$, under Bayes theorem, using broad, flat priors on the parameters $\\Lambda$. For prior ranges, see Table~\\ref{table:prior}.\n\n\\begin{table}[h!]\n\\centering\n\\begin{tabular}{ |c|c|} \n \\hline\n $\\mathcal{A}$ & [0.0, 1.0] \\\\\n $\\mu \\text{ or } \\mu_1, \\mu_2$ & [1.0, 3.0] \\\\\n $\\sigma \\text{ or } \\sigma_1, \\sigma_2$ & [0.01, 1.5] \\\\\n $M_{TOV}$ & [1.5, 3.5] \\\\ \n $M_{BH}$ & [1.5, 10] \\\\\n $\\alpha$ & [0, 10] \\\\\n max $a/a_\\text{Kep}$ & [0.1, 1.0] \\\\\n $\\beta_\\text{s}$ & [0.0, 5.0] \\\\\n $A_1 \\text{(optional)}$ & [-0.5, 0.5] \\\\\n \\hline\n\\end{tabular}\n\\caption{Priors ranges for population parameters.}\n\\label{table:prior}\n\\end{table}\n\n\\subsubsection{Selection Effects}\n\\label{sec:selection}\nWhile we model and measure the astrophysical source distributions, GW detectors observe only sources loud enough to be detected, i.e. sources that produce data above some threshold $d > \\mathrm{thresh}$. We account for this selection effect by including the term $\\xi(\\Lambda)$, the fraction of detectable binaries from a population described by parameters $\\Lambda$.\n\n\\begin{align}\n    \\xi(\\Lambda) &= \\int_{d > \\mathrm{thresh}} \\mathcal{L}({d}|\\theta)\\pi(\\theta|\\Lambda)  \\:dd\\: d\\theta \\nonumber \\\\\n    &\\equiv \\int P_\\mathrm{det}(\\theta) \\pi(\\theta \\mid \\Lambda) d\\theta\n\\end{align}\nTo evaluate $\\xi(\\Lambda)$, we calculate the detection probability $P_\\mathrm{det}(\\theta)$ as a function of masses and cosmological redshift following the semi-analytic approach outlined in \\citet{2017ApJ...851L..25F}. We assume the detection threshold is a simple single-detector signal-to-noise ratio (SNR) threshold $\\rho_\\mathrm{thresh} = 8$. We neglect the effect of spin on detectability; although systems with large aligned spins experience orbital hang-up that increases their SNR compared to small or anti-aligned spins, the effect is small compared to current statistical uncertainties~\\citep{2018PhRvD..98h3007N}. \n\nGiven masses and redshift of a potential source, we calculate its detectability as follow. We first calculate the optimal matched-filter SNR $\\rho_\\text{opt}$ using noise power spectral density (PSD) curves corresponding to aLIGO at O3 sensitivity, Design sensitivity, or A+ sensitivity~\\citep{2020LRR....23....3A}; the optimal SNR corresponds to a face-on, directly-overhead source. We then calculate the SNR $\\rho$ for a random sky position and orientation by generating angular factors $0 < w < 1$ from a single-detector antenna pattern~\\citep{1993PhRvD..47.2198F} and set $\\rho = w\\rho_\\text{opt}$. If $\\rho > \\rho_\\mathrm{thresh}$ for a given detector noise curve, we consider the simulated source to be detected.\n\nFinally, we estimate $\\xi(\\Lambda)$ with a Monte Carlo integral over simulated sources. We draw simulated sources with $m_1, m_2, z$ according to $p_\\mathrm{draw}(\\theta)$ until injection sets of ~10,000 events are created. BH ($m_1$) are drawn from a power law with $M_\\text{BH} = 1.5 M_\\odot$. NS ($m_2$) are drawn from a uniform distribution between $1$ and $3.5 M_\\odot$. Redshifts $z$ are drawn uniform in comoving volume and source-frame time. Each simulated system is labeled as detected or not based on its SNR, described above. We then approximate the integral $\\xi(\\Lambda)$ as a sum over $M_\\mathrm{det}$ detected simulated systems:\n\\begin{equation}\n    \\xi(\\Lambda) \\simeq \\frac{1}{N_\\text{draw}} \\sum_{j=1}^{M_\\text{det}} \\frac{\\pi(m_{1,j}, m_{2,j}, z_j|\\Lambda)}{p_\\text{draw}(m_{1,j}, m_{2,j}, z_j)}\n\\end{equation}\n\n\\subsection{Gravitational Wave Data and Simulations}\n\\subsubsection{Well-Measured Parameters}\nWhile the population distributions in \\ref{models} are defined in terms of $m_1$, $m_2$, $a_1$, and $a_2$, gravitational-wave detectors are most sensitive to degenerate combinations of these parameters. These include the gravitational chirp mass \n\n\\begin{equation}\n    \\mathcal{M} = \\frac{(m_1 m_2)^{3/5}}{(m_1 + m_2)^{1/5}},\n\\end{equation}\n\nthe symmetric mass ratio \n\n\\begin{equation}\n    \\nu = \\frac{q}{(1+q)^2},\n\\end{equation}\n\nand $\\chi_{\\text{eff}}$, a mass-weighted sum of the component spins that is approximately conserved during the inspiral\n\n\\begin{equation}\n    \\chi_{\\text{eff}} = \\frac{m_1 a_{1,z} + m_2 a_{2,z}}{m_1 + m_2}\n\\end{equation}\n\nwhere $a_{1,z}$ and $a_{2,z}$ are the components of the primary and secondary spin that are aligned with the orbital angular momentum axis. If the primary is nonspinning, $\\chi_{\\text{eff}}$ reduces to $\\frac{m_2 a_{2,z}}{m_1 + m_2} = a_{2,z} \\frac{q}{1+q}$.\n\n\\subsubsection{Post-Newtonian Approximation}\n\\label{sec:PN}\n\nWe follow the method outlined in \\cite{2020PhRvD.102f4063C} to simulate realistic parameter estimation samples from mock GW NSBH detections. \n\\cite{2020PhRvD.102f4063C} use the post-Newtonian (PN) description of the GW inspiral, with PN coefficients $\\psi_0, \\psi_2$, and $\\psi_3$ that depend on the masses and spins.\n\n\\begin{equation}\n    \\psi_0(\\mathcal{M}) = \\frac{3}{128\\mathcal{M}^{5/3}\\pi^{5/3}}\n\\end{equation}\n\n\\begin{equation}\n    \\psi_2(\\mathcal{M}, \\nu) = \\frac{5}{96\\mathcal{M}\\pi\\nu^{2/5}}(\\frac{743}{336} + \\frac{11\\nu}{4})\n\\end{equation}\n\n\\begin{equation}\n    \\beta = \\frac{1}{3}(\\frac{113-76\\nu}{4}\\chi_\\text{eff} + \\frac{76}{4}\\delta m \\nu \\chi_{a})\n\\end{equation}\n\n\\begin{equation}\n    \\psi_3(\\mathcal{M}, \\nu, \\beta) = \\frac{3(4\\beta-16\\pi)}{128\\mathcal{M}^{2/3}\\pi^{2/3}\\nu^{3/5}},\n\\end{equation}\nwhere the mass difference $\\delta m = (m_1-m_2)/(m_1+m_2)$ and the spin difference $\\chi_a = (a_{1,z}-a_{2,z})/2$. The third coefficient $\\psi_3$ encodes the spin-orbit degeneracy as $\\beta$ includes the spins and $\\nu$ is the mass ratio. In our case, unlike in \\cite{2020PhRvD.102f4063C}, the $\\chi_{a}$ term is not negligible. For NSBH systems, especially under the assumption of a spinning secondary and nonspinning primary, both the mass difference $\\delta m$ and spin difference $\\chi_a$ are significant.\nFor our mock events, we approximate the measured PN coefficients $\\psi_i$ as independent Gaussian distributions with standard deviations $\\sigma_i$. As in \\citet{2020PhRvD.102f4063C}, we adopt $\\sigma_0 = 0.0046\\psi_0/\\rho$, $\\sigma_2 = 0.2341\\psi_2/\\rho$, and $\\sigma_3 = -0.1293\\psi_3/\\rho$, where we draw the SNR $\\rho$ according to $p(\\rho) \\propto \\rho^{-4}$, an approximation to the SNR distribution of a uniform-in-comoving-volume distribution of sources~\\citep{2014arXiv1409.0522C}. We then sample $m_1$, $m_2$, $a_{1,z}$, and $a_{2,z}$ from the $\\psi_0$, $\\psi_2$, $\\psi_3$ likelihoods, accounting for the priors induced by the change of variables by calculating the appropriate Jacobian transformations. \n\nAn example NSBH parameter estimation posterior generated according to this procedure is shown in Fig. \\ref{fig:simulated}. We see that the masses and spins are highly correlated. In particular, the anti-correlation between the secondary mass and spin increases the uncertainty on $M_\\mathrm{TOV}$ and the spin--maximum mass relationship.\n\n\\section{Application to LIGO--Virgo NSBH Detections}  \\label{ligodata}\n\\subsection{Data and Event Selection}\n\nIn our population inference, we consider up to four LIGO--Virgo triggers as NSBH detections:\\\\\n\n\\begin{enumerate}\n    \\item GW200105 \\citep{2021ApJ...915L...5A}; (all measurements quoted at 90\\% confidence level) $m_1 = 8.9^{+ 1.2}_{-1.5} M_\\odot$, $m_2 = 1.9^{+ 0.3}_{-0.2} M_\\odot$ \\\\\n    \\item GW200115 \\citep{2021ApJ...915L...5A}; $m_1 = 5.7^{+1.8}_{-2.1} M_\\odot$, $m_2 = 1.5^{+0.7}_{-0.3} M_\\odot$ \\\\\n    \\item GW190814 \\citep{2020ApJ...896L..44A}; $m_1 = 23.2^{+1.1}_{-1.0} M_\\odot$, $m_2 = 2.6^{+0.1}_{-0.1} M_\\odot$. Because the secondary mass in GW190814 falls squarely into the putative lower mass gap, it is unclear whether GW190814 is a NSBH or BBH event. Accordingly, we do not include GW190814 in every analysis, but consider how it affects population estimates. \\\\\n    \\item GW190426\\textunderscore 152155 (hereafter GW190426) \\citep{2021PhRvX..11b1053A}; $m_1 = 5.7^{+3.9}_{-2.3} M_\\odot$, $m_2 = 1.5^{+0.8}_{-0.5} M_\\odot$. GW190426 is relatively low-significance with a network SNR of $\\rho = 10.1$, and so may or may not be a real NSBH event. Accordingly, like with GW190814, we do not consider GW190426 in every analysis, but consider how it affects population estimates. \\\\\n\\end{enumerate}\n\nFor GW200105 and GW200115, we use the ``Combined\\textunderscore PHM\\textunderscore high\\textunderscore spin\" parameter estimation samples from~\\citet{2021ApJ...915L...5A}. For GW190426, we use the ``IMRPhenomNSBH\" samples from~\\citet{2021PhRvX..11b1053A}, and for GW190814, we use ``IMRPhenomPv3HM\" from~\\citet{2020ApJ...896L..44A}\\footnote{The parameter estimation samples are available on the Gravitational Wave Open Science Center~\\citep{GWOSC}}.\nThe default LIGO parameter estimation prior $\\pi_\\mathrm{PE}(\\theta)$ is flat in component spin magnitudes and isotropic in spin tilts, following the ``U + I\" spin prior. Meanwhile, the spin models ``ZS\" and ``ZS + AS\" described in Section~\\ref{spin models} assume that the BH is nonspinning ($a_1 = 0$), and ``ZS + AS\" further assumes that the NS spin is perfectly aligned.\nIn these models, we follow \\citet{2020ApJ...895L..28M} and estimate $a_2 = |a_{2,z}/\\text{cos(tilt$_2$)}|$ using the $\\chi_\\text{eff}$ posterior, accounting for the original $\\chi_\\text{eff}$ prior~\\citep{2021arXiv210409508C}.\nTo illustrate the effect of the different spin assumptions on the inferred parameters of each NSBH event, we reweight the original parameter estimation posteriors by the three spin priors (the default ``ZS\", as well as ``ZS + AS\" and ``U + I\") with $\\beta_s = 0$. \nThe $m_1, m_2$ posteriors for the four NSBH events under these three spin models are shown in Figure \\ref{fig:ligom1m2}.\n\\reply{Analyses were performed on an initial set of 4 GW NSBH events from~\\citet{2021PhRvX..11b1053A} and \\citet{2021ApJ...915L...5A}, which were available at the start of this work}. During the course of this work, the latest LIGO--Virgo catalog GWTC-3 was released, which also includes the low-significance NSBH candidates GW190917\\_114630, GW191219\\_163120, GW200210\\_092254~\\citep{2021arXiv211103606T,ligo_scientific_collaboration_and_virgo_2021_5546663}; the inferred masses of these sources under the default priors are also shown in Figure \\ref{fig:ligom1m2}. \\reply{A similar full analysis could be applied to this larger sample of NSBH events, but we find only a slight shift in inferred values of $M_\\text{TOV}$ and $M_\\text{BH}$ with the addition of the 3 GWTC-3 events.}\nIn general, the ``U+I\" model produces the broadest posteriors, while ``ZS + AS\" provides the tightest constraints and the default ``ZS\" model is in the middle. In the ``ZS\" and ``ZS + AS\" model, we see that fixing the BH spin to zero tends to increase the support for lower $m_2$ and higher $m_1$ because of the anti-correlation between $q = m_2/m_1$ and $\\chi_\\mathrm{eff}$, bringing both components out of the putative mass gap~\\citep{2021arXiv210914759M}. Because the secondary spin is poorly measured, $a_2$ is poorly constrained and essentially recovers the broad prior (Figure~\\ref{fig:ligoa2}). \n\nWhen fitting the population models, we divide the NSBH events into four different sets: ``confident'', with just GW200115 and GW200105; ``all'', with all four potential NSBH triggers; and excluding GW190814 and GW190426 one at a time each. For each event set, we repeat the population inference using the three different spin priors -- ``U+I\", ``ZS\", and ``ZS + AS\" -- and three different NS mass models in Section \\ref{ns models} -- uniform, 1-component (1C), and 2-component (2C). Finally, we also vary the pairing function between $\\beta=3$ (preference for equal masses) and $\\beta=0$ (random pairing). In total, we consider 72 model/dataset variations. Unless stated otherwise, results refer to the ``ZS\" spin prior, a 1-component mass function, and random pairing ($\\beta = 0$).\n\n\\subsection{Population Properties}\n\n\\subsubsection{$M_\\text{TOV}$, $M_\\text{BH}$, and the Mass Gap}\nFor each model and dataset variation, we infer the minimum BH mass $M_\\text{BH}$, the NS $M_\\text{TOV}$, and their difference (representing the width of the mass gap), marginalizing over all other parameters of the mass and spin distribution. Results for our \\emph{Default} model are shown in Figs.~\\ref{fig:tov_spin}-\\ref{fig:fullcorner}, with Fig.-\\ref{fig:fullcorner} showing a corner plot over all model parameters.\\\\\n\n{\\bf Maximum (spin-dependent) NS mass}: As discussed in \\ref{ns models}, at a given secondary spin, we model a hard cut-off in the NS mass distribution $p(m_2)$. However, in the 1-component and 2-component models, some values of $\\mu$ and $\\sigma$ taper off the mass distribution between 2--3 $M_\\odot$, making it difficult to discern a sharp truncation mass $M_\\text{TOV}$ from the function's normal behavior. This results in long, flat tails to large posterior values of $M_\\text{TOV}$ (see panel (a) of Fig.~\\ref{fig:tov_spin}), \\reply{reaching the prior bounds even if priors on $M_\\text{TOV}$ are widened}. A better measured parameter is the 99th percentile of the nonspinning NS mass distribution, $M_{99}$ (panel b of Fig.~\\ref{fig:tov_spin}). For models where the $M_\\text{TOV}$ cutoff is significant, the 99th percentile is essentially identical to $M_\\text{TOV}$. For models producing a softer cutoff without significant $M_\\text{TOV}$ truncation, the 99th percentile still captures the largest NS we expect to observe, and, unlike $M_\\text{TOV}$, the inference of $M_{99}$ is consistent between the three NS mass models.\n\nFor models including GW190814, we generally infer $M_{99}$ between $2.6-2.8 M_\\odot$, with lower limits (95\\% credibility) of 2.4-2.5 $M_\\odot$. Our default model (all 4 events, $\\beta = 0$, ``ZS\" spin prior) measures $M_{99} = 2.8^{+0.3}_{-0.2}\\,M_\\odot$ (68\\% credibility); \\reply{the inclusion of 3 additional GWTC-3 events shifts $M_\\text{99}$ to $2.9^{+0.2}_{-0.2} M_\\odot$}. The cutoff mass is set by GW190814, where $m_2$ is extremely well-constrained. Without GW190814, we estimate $M_\\text{TOV}$ between $2.0$--$2.3\\,M_\\odot$, with lower limit (95\\% credibility) of 1.8-1.9 $M_\\text{TOV}$. Without GW190814, our estimates are consistent with other estimates of $M_\\text{TOV}$ from gravitational-wave NS observations that do not consider spin.\n\nThe spin distribution affects the inferred value of $M_\\text{TOV}$ and $M_\\text{99}$. For all four events, $m_2$ is consistent with being both non-spinning ($a_2 = 0$) or maximally spinning ($a_2 = 0.7$, $a/a_\\text{Kep} = 1$). When the spin distribution allows or favors maximally spinning NS, lower values of $M_\\text{TOV}$ are allowed and can still account for GW190814, the most massive secondary. When the spin distribution disfavors high spins, the spin-dependent maximum mass is lower and $M_\\text{TOV}$ must be higher in order to accommodate GW190814.\n\nThis is shown in Figure \\ref{fig:tov_spin}; the posterior on $M_\\text{TOV}$ inferred under a uniform spin distribution ($\\beta_\\text{s} = 0$, $a_\\text{max}/a_\\text{Kep} = 1$), which has support at high NS spins, has a significant tail to lower values below $2.5\\,M_\\odot$ (dashed blue curve).  \nA prior that requires GW190814 to be maximally spinning ($a_\\text{min}/a_\\text{Kep} = 0.9$) brings $M_\\text{TOV}$ estimates even lower, to $\\sim2.4$ $M_\\odot$, with support below $2.2\\,M_\\odot$ (green dashed curve in Fig. \\ref{fig:tov_spin}). Meanwhile, requiring all NSs to be nonspinning ($a_\\text{max}/a_\\text{Kep} = 0$) means that GW190814's secondary (if it is a NS) sets the non-spinning maximum mass for the population, and results in a narrower posterior preferring larger values. The difference between posteriors on $M_\\text{TOV}$ and $M_\\text{99}$ modeled with GW190814 (black solid, red dotted, blue dashed) and without GW90814 (solid yellow curve) is bridged partially by models assuming GW190814's spin is near-maximal. \nThis effect is also visible in Fig. \\ref{fig:traces}; if GW190814 is assumed spinning, the upper end of $p(m_2)$ visibly shifts to lower masses, and zero-spin NS mass functions truncating below GW190814's secondary's mass are allowed (see overplotted credible interval).  We see that even in the absence of well-constrained $a_2$, modeling a spin-dependent maximum mass has significant effects on the inferred NS mass distribution.\n\n\\textbf{GW190814's secondary spin}: Using the posterior on $M_\\text{TOV}$ (Fig. \\ref{fig:tov_spin}) inferred from the population of NSBHs excluding GW190814, we can infer the minimum secondary spin of GW190814 required for it to be consistent with the NSBH population. Results are shown in panel (a) of Fig. \\ref{fig:gw190814_spin}. For our sample of NSBH events excluding GW190814, the results are inconclusive: because the posterior on $M_\\text{TOV}$ is broad, GW190814 is consistent even if non-spinning (with the minimum required $a_2/a_\\text{Kep} = 0$), but it may also be maximally spinning with $a_2/a_\\mathrm{Kep} = 1$. GW190814 may also be an outlier from the NSBH population, even if it is maximally spinning: for this figure, we allow min $a_2/a_\\text{Kep} > 1$, but $a_2/a_\\text{Kep} > 1$ would imply inconsistency with the rest of the population as $a_\\text{max}/a_\\text{Kep} = 1$. Future GW observations of a larger population of NSBH events (see panel (b) of Fig. \\ref{fig:gw190814_spin}) could allow a much tighter measurement of GW190814's secondary spin.\n\n{\\bf Minimum BH mass}: Across all models, the inferred BH minimum mass $M_\\text{BH}$ is between 4--7 $M_\\odot$ with typical uncertainties of $\\pm 1 M_\\odot$. Our default model using the ``ZS\" spin model, all 4 NSBH events (GW190814, GW190426, GW200105, GW200115), and random pairing ($\\beta = 0$) results in $M_\\mathrm{BH} = 5.4^{+ 0.7}_{- 1.0}\\,M_\\odot$ (68\\% credibility). At the low end, we infer $M_\\text{BH} = 4.2^{+ 1.1}_{-1.0}\\,M_\\odot$ using all 4 NSBH events, a uniform NS mass distribution, pairing function $\\beta=3$, and the ``U+I\" spin model. At the high end, we infer $M_\\text{BH} = 6.7^{+ 0.4}_{-0.8}\\,M_\\odot$ (68\\% credibility) using only the confident NSBH events and the  spin model. The effect of the $m_1, m_2$ pairing function $\\beta$ is minimal, but assuming equal-mass pairings further reduces posterior support for low $M_\\text{BH}$ (see Figure \\ref{fig:mbh}). \\\\\n\n{\\bf Mass gap}: We estimate the inferred width of the lower mass gap as the difference between the minimum BH mass, $M_\\text{BH}$, and the maximum nonspinning NS mass, $M_\\text{TOV}$ or $M_{99}$. \\reply{The mass gap's width may range from 0 to a few $M_\\odot$, while the mass gap's position may range from 2-7 $M_\\odot$}. As seen in Figures \\ref{fig:tov_spin} and \\ref{fig:mbh}; the overlap between the posteriors on $M_\\text{BH}$ and $M_\\text{99}$ is low, suggesting the existence of a mass gap. Similarly, panels (a) and (b) in Figure \\ref{fig:ppd} show inferred ($m_1, m_2$) posterior predictive distributions, overplotted with the LVK $m_1, m_2$ posteriors. As Fig. \\ref{fig:ppd} illustrates, {for all model variations we find evidence for a separation between the upper end of the NS mass distribution and the lower end of the BH mass distribution}. \n\nFor our default model, we measure a mass gap of $2.5^{+0.8}_{-1.0} M_\\odot$ \\reply{($2.3^{+0.7}_{-1.0} M_\\odot$ with 3 additional GWTC-3 events)}, wider than $0\\,M_\\odot$ with 97\\% credibility and $1\\,M_\\odot$ with 90\\% credibility. The inferred mass gap is widest when only using the confident NSBH events, between $3.0-4.5 M_\\odot$, and narrowest when using all 4 NSBH events, between $1.5-3.0 M_\\odot$. This is because the mass gap is narrowed from the NS side by the inclusion of GW190814, and from the BH side by the inclusion of GW190426 (see Figure \\ref{fig:ligom1m2}. All model variations (spin prior, $\\beta$, events) support for the existence of a mass gap: $>0\\,M_\\odot$ with 92\\% or higher (up to $>99.9$\\%) credibility, and $>1 M_\\odot$ with 68\\% or higher (up to $>99.9$\\%) credibility.  \n\nAs seen in Fig. \\ref{fig:ligom1m2}, additional spin assumptions (namely assuming that the BH is nonspinning and/or the NS spin is aligned) tend to prefer lower $m_2$ and higher $m_1$, which widens the inferred mass gap. \n\nWhen using spin priors in which the BH is assumed to be nonspinning, even when modeling all 4 events (including GW190814) we infer a mass gap exists with $>96\\%$ credibility and that it is wider than $1\\,M_\\odot$ with $>90\\%$ credibility.\n\n\\subsubsection{Mass and spin distributions}\nIn addition to the most astrophysically relevant parameters -- $M_\\text{BH}$, $M_\\text{TOV}$, and the width of the mass gap -- we also constrain other parameters of the primary and secondary mass functions. In this section, we discuss general trends in the mass distribution shape, as inferred from posterior traces (Figure \\ref{fig:traces}).\n\nWe first consider the NS mass distribution, $p(m_2)$, which differs slightly depending on the mass model used. \nFor the 1-component model, we generally infer a broad distribution ($\\sigma \\simeq 0.5$) with mean $\\mu$ between $1.2$ and $1.6 M_\\odot$. A broad distribution is especially necessary to explain the large secondary mass of GW190814. The 2-component model generally agrees well with the 1-component model, although additional substructure (see panel (a) of Fig. \\ref{fig:traces}), particularly a narrower peak at around 1.3 $M_\\odot$ and a longer tail to high NS masses (above $2 M_\\odot$) is possible. The only free parameter in the uniform model is the cutoff mass $M_\\text{TOV}$. Though the flatness of the uniform model means we necessarily infer higher probability at masses near $M_\\text{TOV}$, $M_\\text{TOV}$ is generally consistent with the upper limit (99th percentile $M_{99}$) inferred from other mass models.  \n\nThe BH mass function is consistent between the three NS mass models. The most significant influence is the pairing function ($\\beta = 0$ for random or $\\beta = 3$ for equal-mass preference). For example, under our default model \\reply{(4 events)}, which includes random pairing ($\\beta = 0$), we infer a distribution with power-law slope $\\alpha_\\text{BH} = 3.4^{+1.4}_{-0.9}$ \\reply{($\\alpha_\\text{BH} = 2.3^{+7}_{-1.0}$ with all 7 events)}. Under the same assumptions but preferring equal masses, $\\beta = 3$, the inferred distribution shifts to significantly shallower slopes, $\\alpha_\\text{BH} = 0.9^{+1.1}_{-0.6}$. This is because the preference for equal-mass pairing requires a shallower slope in order to account for higher-mass black holes, especially the primary of GW190814. \n\nAs seen in Fig. \\ref{fig:fullcorner}, the joint posterior on $\\beta_\\text{spin}$ and $a_\\text{max}/a_\\text{Kep}$ prefers low $a_\\text{max}/a_\\text{Kep}$ and high $\\beta_\\text{spin}$, but mainly recovers the flat prior, which inherently prefers steeper and smaller spin distributions. Thus our measurement of the NS spin distribution is mostly uninformative, with a very mild preference for small spins."}