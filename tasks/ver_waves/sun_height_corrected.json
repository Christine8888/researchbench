{
    "task_id": "sun_height_corrected",
    "kind": "numeric",
    "difficulty": 4,
    "description": "Calculate the corrected height of the Sun above the Galactic mid-plane by accounting for north-south asymmetry in stellar number counts using Gaia DR2 data.",
    "instructions": "This task builds on the solar_height_from_gaia_dr2 task, where you determined the initial estimate of the Sun's height ($z_\\odot$) using a symmetric density model. Now, correct this estimate by accounting for the north-south asymmetry in stellar number counts.\n\nStep 1 - Calculate number count asymmetry\n* Using the same stellar sample from the previous task, compute the number count asymmetry parameter for each vertical position bin:\n  $A(z) = \\frac{n(z) - n(-z)}{n(z) + n(-z)}$\n* Use the initially determined $z_\\odot$ from the previous task to correct observed heights to Galactic mid-plane reference frame before computing asymmetry.\n* Bin stars in constant vertical height bins of 25 pc.\n\nStep 2 - Fit a spline to the asymmetry pattern\n* Calculate the median asymmetry across all color bins at each height.\n* Fit a smooth spline function to these median asymmetry values.\n\nStep 3 - Create asymmetry-corrected density model\n* Modify the symmetric density model to account for asymmetry using the relationship:\n  $n(z) = \\begin{cases}\n  N(z)[1-A(z)] & \\text{if } z \\leq 0 \\\\\n  N(z)[1+A(z)] & \\text{if } z > 0\n  \\end{cases}$\n* Where $N(z)$ is the same two-component model as before:\n  $N(z) = N_0 [ \\text{sech}^2((z + z_\\odot)/(2H_1)) + f \\cdot \\text{sech}^2((z + z_\\odot)/(2H_2)) ]$\n\nStep 4 - Refit the model with asymmetry correction\n* For each color slice, refit the stellar number counts using this asymmetry-corrected model.\n* Maximize the Poisson log-likelihood to determine the best-fit parameters, including the corrected $z_\\odot$.\n* Record the best-fit $z_\\odot$ and its variance for each color slice.\n\nStep 5 - Combine results across color slices\n* Compute the inverse-variance-weighted mean of $z_\\odot$ across all color slices.\n* Estimate the uncertainty on this weighted mean through bootstrapping.\n\nReturn one number: the asymmetry-corrected weighted-mean $z_\\odot$ in parsecs, rounded to one decimal place.",
    "tolerance": 0.5,
    "expected_output": 20.8,
    "output_justification": "As stated in Section 4 of the paper, the estimated solar height is improved and becomes 20.8 Â± 0.3 pc.",
    "parents": ["solar_height_from_gaia_dr2"]
  }
