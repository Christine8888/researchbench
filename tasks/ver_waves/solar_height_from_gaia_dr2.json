{
    "task_id": "solar_height_from_gaia_dr2",
    "kind": "numeric",
    "difficulty": 3,
    "description": "Determine the Sun's height above the Galactic mid-plane by analyzing the vertical stellar distribution in Gaia DR2 data using a symmetric density model.",
    "instructions": "Using astroquery.gaia, build a sample from gaiadr2.gaia_source that fulfils all of the following criteria:\n\n* 7 < phot_g_mean_mag < 17\n* parallax > 0\n* parallax_over_error > 5\n* projected heliocentric distance in the Galactic plane ≤ 250 pc, where distance = $1000/\\text{parallax}$ (pc) and $R_{xy} = \\text{distance} \\times \\cos b$\n\nStep 1 - colour slicing & main-sequence selection\n* Work in 0.1-mag slices of $(G_{BP} - G_{RP})$ from 0.7 to 2.1 inclusive (14 slices total).\n* For each slice, compute absolute G: $M_G = \\text{phot\\_g\\_mean\\_mag} - 5 \\log_{10}(\\text{distance}) + 5$.\n* Create a histogram of $M_G$ with bin width of 0.2 mag, fit a Gaussian to the main-sequence peak, and retain only stars within $\\pm 2\\sigma$ of the peak.\n\nStep 2 - completeness height\n* For each slice, derive the bright/faint distance limits from the distance modulus with $m_{\\text{bright}} = 7$ and $m_{\\text{faint}} = 17$:\n  * $d_1 = 10^{(7 - M_{\\text{bright}} + 5)/5}/1000$ (kpc)\n  * $d_2 = 10^{(17 - M_{\\text{faint}} + 5)/5}/1000$ (kpc)\n* Compute $h = \\sqrt{d_2^2 - 0.25^2}$ (kpc) and cap $h$ at 2 kpc.\n* Retain stars with $|z| \\leq h$, where $z = \\text{distance} \\times \\sin b$.\n\nStep 3 - vertical density fit per slice\n* Bin raw counts $n(z)$ in 25-pc bins.\n* Fit the two-component model:\n  $N(z) = N_0 [ \\text{sech}^2((z + z_\\odot)/(2H_1)) + f \\cdot \\text{sech}^2((z + z_\\odot)/(2H_2)) ]$\n  by maximising the Poisson log-likelihood given by:\n  $\\ln p(N_{\\text{obs}}|N) = \\sum_i [-N_i + N_{\\text{obs},i}\\ln(N_i) - \\ln(N_{\\text{obs},i}!)]$\n* Use optimization (e.g., maximum likelihood estimation) to find initial parameter values, followed by MCMC to determine uncertainties.\n* Record the best-fit $z_\\odot$ and its variance for each colour slice.\n\nStep 4 - combine slices\n* Compute the inverse-variance-weighted mean of $z_\\odot$ across all colour slices.\n* Estimate the uncertainty on this weighted mean through bootstrapping (as described in the paper).\n\nReturn one number: the weighted-mean $z_\\odot$ in parsecs, rounded to one decimal place.",
    "tolerance": 0.7,
    "expected_output": 20.3,
    "output_justification": "This value comes directly from Section 3 of the paper where the authors state \"Through bootstrapping, we get a mean value of z_⊙ = 20.3 ± 0.7 pc\" before accounting for asymmetry. The task replicates the data selection, binning, model fitting, and statistical approach used in the paper.",
    "parents": []
  }
