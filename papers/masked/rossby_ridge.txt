
\begin{document}
\title{Further Evidence of Modified Spin-down in Sun-like Stars:\\Pileups in the Temperature--Period Distribution}

\affil{\cca}
\affil{\amnh}

\affil{\amnh}
\affil{\cca}
\affil{\columbia}

\affil{\columbia}

\affil{\ifa}

\affil{\amnh}

\affil{\cca}

\affil{\columbia}
\affil{\amnh}

\affil{\amnh}

\begin{abstract}
We combine stellar surface rotation periods determined from NASA's Kepler mission with spectroscopic temperatures to demonstrate the existence of pileups at the long-period and short-period edges of the temperature--period distribution for main-sequence stars with temperatures exceeding $\sim$\teffmin. The long-period pileup is well-described by a curve of constant Rossby number, with a critical value of [NUMERICAL_RESULT]. The long-period pileup was predicted by \citet{vanSaders2019} as a consequence of weakened magnetic braking, in which wind-driven angular momentum losses cease once stars reach a critical Rossby number. Stars in the long-period pileup are found to have a wide range of ages ([NUMERICAL_RESULT]), meaning that, along the pileup, rotation period is strongly predictive of a star's surface temperature but weakly predictive of its age. The short-period pileup, which is also well-described by a curve of constant Rossby number, is not a prediction of the weakened magnetic braking hypothesis but may instead be related to a phase of slowed surface spin-down due to coreâ€“envelope coupling. The same mechanism was proposed by \citet{Curtis2020} to explain the overlapping rotation sequences of low-mass members of differently aged open clusters. The relative dearth of stars with intermediate rotation periods between the short- and long-period pileups is also well-described by a curve of constant Rossby number, which aligns with the period gap initially discovered by \citet{McQuillan2013b} in M-type stars. These observations provide further support for the hypothesis that the period gap is due to stellar astrophysics, rather than a non-uniform star-formation history in the Kepler field.
\end{abstract}

\keywords{Stellar rotation (1629) --- Solar analogs (1941) --- Stellar evolution (1599) --- Stellar magnetic fields (1610) --- Stellar winds (1636)}

\section{Introduction} \label{sec:intro}

Solar-type and low-mass stars ($M\lesssim1.3$~\msun) lose mass and angular momentum through magnetized winds \citep{Parker1958, WeberDavis1967, Mestel1968, Kawaler1988}. Consequently, stellar rotation rates are observed to decline with age. \citet{Skumanich1972} presented the first attempt to calibrate this age-rotation relationship using the rotation periods of Sun-like stars in open clusters with independently determined ages, finding a $P_\mathrm{rot} \propto t^{1/2}$ scaling, where $t$ is stellar age. In the intervening decades, observational determinations of stellar rotation periods among open cluster members revealed how stellar spin rates evolve in more detail, leading to the calibration of the so-called gyrochronology method \citep{Barnes2003, Barnes2007, Barnes2010, MamajekHillenbrand2008, Meibom2009, Angus2019}.

The arrival of continuous, high-precision, long-baseline photometry from NASA's Kepler space telescope \citep{Borucki2010} provided a watershed moment for stellar rotation studies, yielding period detections for tens of thousands of stars \citep[e.g.][]{Reinhold2013, McQuillan2014, Santos2021} and allowing for gyrochronology to be extended to older ages \citep[e.g.][]{Meibom2011, Meibom2015}. NASA's subsequent K2 \citep{Howell2014} and TESS \citep{Ricker2015} missions propelled the field of stellar rotation further still, providing an exquisitely detailed picture of how spin rates evolve for stars with a broad range of masses and ages in stellar associations \citep[e.g.][]{Douglas2016, Douglas2017, Douglas2019, Rebull2016, Rebull2017, Rebull2018, Rebull2020, Curtis2019a, Curtis2019b, Curtis2020}. New and evermore precise data is becoming available at a rate that is outpacing efforts to re-calibrate gyrochronology, which is necessary to capture the complex relationship between a star's spin and its age. 

For example, efforts to calibrate gyrochronology relations using Kepler asteroseismic targets revealed tension with relations calibrated to open clusters and found that rotation periods could not be described by a single power-law relation with age \citep{Angus2015}. This tension, at least in part, is due to the fact that standard gyrochronology models are unable to account for the anomalously rapid rotation rates of stars older than the Sun, leading to the suggestion that stars with Rossby numbers of Ro~$\gtrsim$~\rosun experience a phase of weakened magnetic braking \citep[WMB,][]{vanSaders2016}. 

Forward modeling simulations of the observed Kepler rotation period distribution also provided support for the WMB hypothesis over standard spin-down models, in that WMB models are better able to match the observed long-period edge \citep[][hereafter vS19]{vanSaders2019}. Those authors also predicted a pileup of stars along the long-period edge, which they hypothesized could not be seen in the \citet{McQuillan2014} sample (hereafter \mma) due to large errors on \teff in the revised Kepler Input Catalog \citep[KIC,][]{Huber2014}. While \jvs favored the WMB hypothesis to explain observations, those authors were also careful to point out that a long-period edge can be caused by detection biases, as stars with longer rotation periods (and larger Rossby numbers) have smaller amplitude variations which pose more difficulty to period-detection algorithms. 

More recently, \citet{Hall2021}, hereafter H21, used the asteroseismic rotation rates of Kepler dwarfs, with different selection and detection biases from the \jvs study and the present work, to argue support for the WMB model. \citet{Masuda2021}, hereafter MPH21, also found support for the WMB hypothesis from inference of the rotation period distribution of Sun-like stars using stellar radii and projected rotational velocities. While the physics responsible for the weakened magnetic braking of solar-type stars is unknown, one hypothesis is that the declining efficiency of wind-driven angular momentum loss is connected to the magnetic field complexity, which may vary with Rossby number \citep[e.g.][]{Reville2015, vanSaders2016, Garraffo2016, Metcalfe2016, Metcalfe2019}. 

Here we examine the rotation period distribution of stars observed by Kepler, leveraging the recent release of precise spectroscopic parameters from large-scale surveys, to demonstrate the existence of pileups at the long- and short-period edges of the \teff--\prot distribution of solar-type stars. We discuss our sample in \S\ref{sec:sample}, describe the steps of our analysis in \S\ref{sec:analysis}, discuss some implications of these results in \S\ref{sec:discussion}, and present our conclusions in \S\ref{sec:conclusions}.

\section{Sample Selection} \label{sec:sample}
Below, we describe the samples utilized in this work. All stars characterized here were targets of NASA's Kepler mission \citep{Borucki2010} and have published rotation periods derived from the Kepler data. For each subsample of the Kepler field described below, we combined published rotation periods from a variety of literature sources with spectroscopic parameters provided by large-scale surveys (Figure~\ref{fig:surveys}).

\begin{figure*}
 \centering
 \includegraphics[width=\textwidth]{./figures/surveys.pdf}
 \caption{The \teff-\prot plane using rotation periods from \mma or, in the case of the CKS sample, \citet{McQuillan2013} which applied an identical analysis to Kepler Objects of Interest (KOIs), with \teff originating from the source denoted at top. The \mma \teff values originate from the Kepler Input Catalog \citep[KIC,][]{Brown2011} or \citet{Dressing2013} for low-mass stars. The orange point in each panel indicates the Sun's equatorial rotation period, with the errorbar capturing the range of periods measured from the activity belts. Many of the stars above the long-period pileup are subgiants which have experienced spin-down due to expansion off the main-sequence, as pointed out in \jvs.}
 \label{fig:surveys}
 \script{surveys.py}
\end{figure*}

\subsection{California--Kepler Survey} \label{subsec:cks}
The CKS project acquired high-resolution spectroscopy for 1305 Kepler planet host stars \citep{Petigura2017}. CKS spectra were acquired with the Keck/HIRES spectrograph \citep{Vogt1994} and spectroscopic parameters were determined by averaging parameters from the SpecMatch pipeline \citep{Petigura2015} and SME@XSEDE, a Python implementation of the Spectroscopy Made Easy pipeline \citep{Valenti1996}. The internal (relative) errors on \teff from the CKS catalog are estimated at $\pm$60~K, with systematic errors of $\pm$100~K estimated from comparison to other catalogs \citep[see Table 7 of][]{Petigura2017}. The metallicity distribution of the CKS sample is centered near solar, with a mean and standard deviation of +0.03~dex and 0.18~dex, respectively.

We compiled rotation periods for these stars from a variety of literature sources including \citet{McQuillan2013, Mazeh2015} and \citet{Angus2018}. For each star in the sample we then visually inspected the Kepler light curve folded on all available literature periods, as well as the first harmonics and sub-harmonics of those periods, and recorded our preferred period along with a reliability flag. Our procedure is explained in detail in \S2.1 of \citet{David2021}, and rotation period vetting sheets for each Kepler Object of Interest (KOI) are publicly available through Zenodo.} The vast majority of stars in the CKS sample host small planets ($R_P < 4$~\rearth) and as such it is not expected that the host stars have experienced tidal spin-up from the planets.

In addition to the original CKS catalog, we also cross-matched our sample with the catalogs of \citet{Brewer2018} and \citet{Martinez2019}, both of which presented spectroscopic parameters for CKS stars based on independent analysis of the same spectra. The \citet{Brewer2018} study, referred to here as SPOCS, also published elemental abundances and ages from isochrone fitting for the CKS sample. We additionally cross-matched the CKS catalog with the LAMOST DR5 catalog \citep{Xiang2019} which is described further in \S\ref{subsec:lamost}. We compare the \teff--\prot distributions of the CKS sample using \teff and rotation periods from a variety of sources in Appendix~\ref{app:teffprot}.

\subsection{LAMOST \label{subsec:lamost}}
The LAMOST project derived homogeneous spectroscopic parameters from low-resolution ($R\sim$~1800) LAMOST DR5 spectra for approximately 40\% of the Kepler field \citep{Zong2018, Xiang2019}. A description of the LAMOST Kepler field observations is provided in \citet{deCat2015}. The \citet{Xiang2019} catalog derived stellar parameters using the DD-Payne pipeline, which builds on the method of \citet{Ting2017b} by incorporating elements of the Cannon \citep{Ness2015} and uses the overlap with GALAH DR2 and APOGEE DR14 as training data. We cross-matched the LAMOST DR5 stellar parameter catalog of \citet{Xiang2019} with the \mma catalog, which published rotation periods for $>$34000 Kepler targets, as well as the \citet{Santos2021} catalog (hereafter S21), which provides rotation periods for $>$55000 FGKM stars observed by Kepler.

We matched 10844 LAMOST targets to 10550 unique Kepler IDs in \mma, resulting in a sample with well-determined \prot and spectroscopic \teff (having a median error of [NUMERICAL_RESULT]~K). For the Kepler sources with duplicate cross-matched LAMOST sources we kept the source with a brighter Gaia DR2 $G$ magnitude. In the \santos sample we found 54982 unique cross-matched sources in LAMOST, of which 18990 have published temperatures and rotation periods. The metallicity distribution of the LAMOST--McQuillan sample is centered near solar, with a mean and standard deviation of $-0.1$~dex and 0.26~dex, respectively. There is negligible overlap (3 stars) between our LAMOST--McQuillan sample and the CKS sample since \mma did not publish rotation periods for KOIs, which were the targets of the CKS project. Rotation periods for KOIs are instead published in \citet{McQuillan2013}, as discussed in \S\ref{subsec:cks}. Visualizations of the \lamostmcq and \lamostsan samples are shown in Figure~\ref{fig:xmatch}.

\newpage
\subsection{APOGEE}
The Apache Point Observatory Galactic Evolution Experiment \citep[APOGEE;][]{Majewski2017} is a large-scale, high-resolution ($R \sim 22500$) stellar spectroscopic survey conducted at $H$-band as part of the Sloan Digital Sky Survey \citep[SDSS-IV;][]{Blanton2017}. The spectroscopic analysis pipeline for SDSS DR16 is described in \citet{Jonsson2020}. We used Gaia DR2 source IDs \citep{Gaia2016, Gaia2018} to cross-match Megan Bedell's Gaia--Kepler catalog} with the APOGEE DR16 catalog \citep{Ahumada2020}. Kepler IDs were then used to cross-match this table with the \mma catalog. While the current overlap between Kepler targets and APOGEE is small compared to the LAMOST catalog, APOGEE DR17 will contain more dwarf stars and provide a better resource for studies such as ours. The focus of this work are overdensities in the \teff--\prot plane, and as these appear to be less prominent when using APOGEE DR16 temperatures (Figure~\ref{fig:surveys}) we conclude that LAMOST and CKS provide more precise estimates of \teff and do not analyze the APOGEE sample further. 

\subsection{The Sun}
To place the Sun in the context of the long-period pileup, we use up-to-date estimates of the Sun's effective temperature, color, rotation period, and age. Following the IAU 2015 Resolution B3 \citep{Prsa2016}, we take the nominal effective temperature of the Sun to be $\mathcal{T}^\mathrm{N}_\mathrm{eff,\odot} = 5772$~K. For the color and apparent magnitude of the Sun in the Gaia bandpasses we adopt $G_\mathrm{BP}-G_\mathrm{RP} = 0.818$~mag and $G = -26.895$~mag \citep{Casagrande2018}. For the solar rotation period we adopt the equatorial rotation period of $P_\mathrm{eq,\odot}~\approx~25.4$~d. While helioseismic differential rotation studies have inferred rotation periods of up to $\approx$~36~d near the poles \citep[][and references therein]{Thompson2003}, sunspots are rarely observed outside the activity belts, roughly $\pm 30^\circ$ from the equator \citep[][and references therein]{Hathaway2015}. We therefore adopt 27~d as an approximate upper limit to the rotation period of the Sun, as it would be observed by Kepler through rotational brightness modulations. are calibrated to the Sun's equatorial rotation period of 25.4~d.} The age of the Sun is assumed to be 4.567~Gyr from Pb-Pb dating of calcium-aluminum inclusions and chondrules recovered from primitive meteorites \citep[][and references therein]{Bahcall1995}.

\section{Analysis}
\label{sec:analysis}

\subsection{Initial observations}
We first noted a pileup of stars along the long-period edge for stars with \teff~$>5800$~K when examining the \teff-\prot plane for the CKS sample, using the CKS \teff values and the vetted rotation period compilation from \citet{David2021}. The pileup in that sample is visible even when sourcing \prot uniformly from \citet{McQuillan2013}, as shown in the rightmost panel of Figure~\ref{fig:surveys}. Sourcing rotation periods from \citet{Mazeh2015}, \citet{Angus2018}, and \santos revealed that this pileup is still apparent when adopting periods uniformly from other catalogs as well (see Appendix~\ref{app:teffprot}). It is thus the \teff precision afforded by spectroscopic catalogs that reveal the long-period pileup. In Appendix~\ref{app:gaia}, we demonstrate that it is possible to recover the long-period pileup in the colorâ€“period plane using high-precision photometry from the Gaia mission \citep{Gaia2016} and selecting stars with minimal interstellar reddening.

Comparing the long-period pileup to rotation period sequences from open clusters can provide insight into the ages of stars on the pileup. The long-period pileup is close to the empirical hybrid cluster sequence derived by \citet{Curtis2020}, hereafter \curtis, from members of the NGC~6819 (age~$\sim$~2.5~Gyr) and Ruprecht~147 (age~$\sim$~2.7~Gyr) open clusters (Figure~\ref{fig:kde}). Notably, we use the color--\teff relation presented by those authors to recast the cluster sequences in terms of \teff. The observation that the long-period pileup approximately corresponds with the $\sim$2.5--2.7~Gyr cluster sequence implies that stars with \teff$\gtrsim$~\teffmin have already piled up onto the edge by or before this timescale. Similarly, the long-period pileup clearly lies at longer periods than the empirical $\sim$1~Gyr cluster sequence based on rotation rates in the NGC~6811 cluster \citep{Curtis2019a, Curtis2020}, implying that it takes F-type stars $>1$~Gyr to reach the long-period pileup. These observations are in accordance with predictions from the WMB model which suggest the pileup forms on a timescale of 2--3~Gyr \citep{vanSaders2019}. We show in \S\ref{subsec:ages} that stars along the pileup have a range of ages, with a lower bound that is consistent with [NUMERICAL_RESULT].

\begin{figure*}
 \centering
 \includegraphics[width=\linewidth]{./figures/kde.pdf}
 \caption{Gaussian kernel density estimation (blue contours) of the \teff--\prot distributions of the CKS--McQuillan, \lamostmcq, and asteroseismic \hall samples, from left to right. Empirical cluster sequences from \curtis are shown by the dark grey lines. The orange dashed lines show constant Rossby curves of fiducial values (see \S\ref{subsec:rossby}). The short-period pileup can be observed in the LAMOST--McQuillan sample for \teff~$\gtrsim$~5500~K. The orange point indicates the Sun's temperature and equatorial rotation period, with the errorbar capturing the range of periods measured from the activity belts.}
 \label{fig:kde}
 \script{kde.py}
\end{figure*}

A change in slope along the long-period edge is observed in both the CKS and LAMOST samples (Figure~\ref{fig:inflection}), with an inflection point corresponding closely to the Kraft break at $\approx$~6250~K, the point at which convective envelopes become vanishingly thin \citep{Kraft1967}. A piecewise linear fit to the ridge in the CKS sample confirmed that the inflection point occurs at \teff~=~[NUMERICAL_RESULT]~$\pm$~[NUMERICAL_RESULT]~K, where the uncertainty was estimated from Markov chain Monte Carlo (MCMC) sampling. This change in slope may be due to the fact that the convective turnover timescale, \taucz, changes rapidly above 6250~K.

In the CKS sample, there also appears to be a clustering of stars above the ridge with \teff~$>6100$~K (seen most clearly in Figure~\ref{fig:inflection}). This cluster of points has a similar slope in the \teff--\prot plane as the long-period pileup, and does not reside on the harmonic of the ridge line as one might expect if the periods were erroneously determined. A similar clustering of points is not observed in the \lamostmcq sample and is less pronounced or absent when substituting the CKS temperatures with \teff from either \citet{Brewer2018} or \citet{Martinez2019}, two studies that independently derived spectroscopic parameters from the CKS spectra. Further inspection of the stars in this cluster revealed that they have anomalously large \teff discrepancies between the CKS and SPOCS catalogs, such that the SPOCS temperatures shift the stars onto the long-period pileup. We conclude that the temperatures for these stars in the CKS catalog are too high by $\gtrsim$~100~K.

A secondary pileup at the short-period edge is also apparent, though less pronounced, in the \teff--\prot distribution of the \lamostmcq sample. We verified through inspection that the secondary pileup does not lie along the \prot/2 harmonic line of the long-period pileup (see Appendix~\ref{app:harmonics}). As shown in the middle panel of Figure~\ref{fig:kde} and the top panel of Figure~\ref{fig:mcmc}, this secondary pileup is seen most clearly through applying Gaussian kernel density estimation (KDE), which was performed with the \texttt{seaborn} package \citep{seaborn}. The short-period pileup is also subtly apparent in the upper right panel of Figure~\ref{fig:xmatch}, as well as scatter plots of the \lamostmcq sample, e.g. the second panel of Figure~\ref{fig:surveys} and the bottom panels of Figures~\ref{fig:models} and \ref{fig:shifted}.

\subsection{Constant Rossby model}
\label{subsec:rossby}
In the WMB model of \citet{vanSaders2016, vanSaders2019}, a star spins down until it reaches a critical Rossby number, at which point magnetic braking ceases. Since Rossby number is highly sensitive to temperature through its dependence on the convective turnover timescale ($\mathrm{Ro} = P_\mathrm{rot}/\tau_\mathrm{cz}$, where $\tau_\mathrm{cz}$ is the convective turnover timescale), this critical threshold corresponds to different rotation periods for stars of different \teff, leading to a pileup in the \teff-\prot plane. Using a small sample of Kepler targets with rotation periods determined from brightness modulations, \citet{vanSaders2016} proposed this threshold happens at a critical Rossby number of $\mathrm{Ro_{crit}} \sim \mathrm{Ro_\odot}$. 

We tested the hypothesis that the long-period pileup observed in the \lamostmcq sample is compatible with the WMB model by fitting constant Rossby models to the \prot boundary. For a given \teff, this model predicts \prot as: 
where we used the equation for the convective turnover timescale (valid in the \teff range of 3300~K$\lesssim \teff \lesssim$~7000~K) presented in \citet{CranmerSaar2011} from a fit to the zero-age main-sequence stellar models of \citet{Gunn1998}:
\begin{multline} \label{eq:2}
\tau_\mathrm{cz}(\teff) = 314.24\exp \left [ -\left (\frac{T_\mathrm{eff}}{1952.5 \mathrm{K}} \right ) - \left (\frac{T_\mathrm{eff}}{6250 \mathrm{K}} \right )^{18} \right ] \\+ 0.002.
\end{multline}

The above relation yields a convective turnover timescale for the Sun of $\tau_\mathrm{cz,\odot} = 12.88$~d, leading to a Rossby number of $\mathrm{Ro_\odot}=1.97$ given the mean equatorial rotation period of $P_\mathrm{rot,\odot} = 25.4$~d. For comparison, in the model grids used to create the population models in \S\ref{subsec:models} the solar Rossby number is $\approx$2.16.

We approximated the long-period edge in the following manner. For 100 bootstrapped resamplings of the \teffâ€“\prot distribution, leaving out 50\% of the data for each bootstrapped sample, we computed the 90th percentile of \prot values in overlapping \teff bins with centers located every 20~K between 4000~K and 7000~K and half-widths of 100~K. The final long-period edge curve was then computed as the mean of the bootstrapped 90th percentile values. We found it was also necessary to omit stars with Ro~$>$~5/3 in this computation to match the long-period edge. We computed the 10th percentile curve and its uncertainty similarly, as an approximation to the lower boundary of the \teff-\prot plane. We show these curves in relation to the full \lamostmcq sample and to constant Rossby models in Figure~\ref{fig:mcmc}.

We performed an initial Levenberg-Marquardt non-linear least-squares fit of a constant Rossby model to the long-period edge with the \texttt{curve\_fit} function in the \texttt{scipy.optimize} class to optimize the following likelihood: 

\begin{multline} \label{eq:3}
 \ln{p} (y | T_\mathrm{eff}, T_\mathrm{sys}, \sigma, \mathrm{Ro}, f) =\\ -\frac{1}{2}\sum_n \left [ \frac{(y_n - P_\mathrm{rot}(\mathrm{Ro}, T_\mathrm{eff} + T_\mathrm{sys}))^2}{s_n^2} + \ln{(2\pi s_n^2)} \right ],
\end{multline}

where


\begin{equation} \label{eq:4}
 s_n^2 = \sigma^2 + f^2 P_\mathrm{rot}(\mathrm{Ro}, T_\mathrm{eff} + T_\mathrm{sys})^2,
\end{equation}

and $y_n$ is the value of a \prot percentile curve in the $n$th \teff bin. This is a Gaussian likelihood where the variance is underestimated by some fraction, $f$. Here $T_\mathrm{sys}$ is a constant to allow for a systematic offset between the data and the models used to calibrate the \taucz relation. This offset can equivalently be thought of as a correction to the data, or a correction to the model \teff scale. We performed Markov chain Monte Carlo sampling (MCMC) of this likelihood with the \texttt{emcee} package \citep{emcee2013, emcee2019} to estimate the mean and uncertainty of the critical Rossby number that best matches the long-period edge in the range of 5000~K$\lesssim \teff \lesssim$~6250~K. We instantiated 32 walkers around the least-squares solution and sampled for $10^5$ steps, adopting uniform priors on Ro, $f$, and $T_\mathrm{sys}$ with ranges of (0.1,10), (0,10), and (-1000~K, 1000~K), respectively. Convergence was assessed by ensuring the chain length was at least 100 times longer than the chain autocorrelation lengths for each parameter. A similar analysis was performed for the 10th percentile curve, restricted in the range of 4500~K$\lesssim \teff \lesssim$~5800~K where a constant Rossby model provides a reasonable fit. 

We additionally fit the CKS long-period pileup (using three different homogeneous \teff sources) and the \hall asteroseismic main-sequence sample, allowing for \teff offsets in each data set (Table~\ref{tab:mcmc}). For the CKS pileup stars and the \lamostmcq percentile curves, we assumed constant fractional \prot uncertainties of 10\%. To isolate the long-period pileup stars in the CKS sample, we selected a trapezoidal region using the condition $-0.0314~\teff + 199.286 < \prot < -0.0314~\teff + 206.286$ (shown in Figure~\ref{fig:inflection}). We note that this selection is particular to the CKS \teff scale and is not general. For the CKS sample, we additionally required $\logg~>~4$ and 5850~K~$<~\teff~<$~6500~K. 

The constant Rossby model provides a reasonably good description of the \lamostmcq long-period edge in the \teff range of $\approx$~5000--6250~K, with fractional residuals $\lesssim5\%$ over this range. Above and below this \teff range we see clear and significant divergence from the constant Rossby model, such that the model under-predicts periods of hotter stars and over-predicts periods of cooler stars, possibly because the cooler stars have not had enough time to evolve to the critical Rossby number associated with weakened magnetic braking \citep[see Figure 6 in][]{vanSaders2019}.

In some cases, our constant Rossby fits to the long-period pileup prefer Rossby numbers lower than the Sun's, in contrast with \jvs. We caution against overinterpreting the specific \rocrit values inferred here, and discuss our interpretations further in \S\ref{subsec:longperiod}.

To further quantify the preference for \rocrit~$<$~\rosun we performed non-linear least-squares fits of two models to the CKS long-period pileup and the \lamostmcq 90th percentile curve (both in the \teff range of 5800--6250~K). The first model assumes \rocrit = \rosun and has one free parameter, a temperature offset added to the data. The second model assumes no temperature offset and allows \rocrit to vary (\rocrit being the only free parameter). The results of these fits are shown in Figure~\ref{fig:rocrit}. We found that for the CKS sample, particularly when using the more precise temperatures from \citet{Fulton2018}, that the $\Delta \chi^2$ between the \rocrit = \rosun and variable \rocrit models was negligible. In other words, the \rocrit = \rosun model fits the data well with a \teff shift of $\approx$~70--140~K depending on the \teff source used. For the \lamostmcq sample, there is weak support for the variable \rocrit model. However, as shown in Appendix~\ref{app:teff}, there is a strong systematic trend not adequately captured by a constant offset (i.e. a \teff-dependent \teff offset) in the LAMOST temperatures when compared to other spectroscopic catalogs (particularly SPOCS). Correcting for these systematic trends weakens the support for the variable \rocrit model, and we speculate that temperature systematics bias the \rocrit inference procedure. 




\subsection{Comparison with theory}
\label{subsec:models}

We compared the \teff--\prot distribution of the CKS and \lamostmcq samples with the theoretical predictions of \citet{vanSaders2019}, which were updated for \citet{Hall2021} and utilized in that work. Those authors presented forward modeling simulations of the observed Kepler \prot distribution including theoretical models of stellar angular momentum evolution (for both the standard spin-down and WMB scenarios), a galactic population model, and a prescribed observational selection function. For this exercise we selected main-sequence stars from the simulations using an evolutionary state flag, defining main-sequence stars as those with a He core mass fraction $<$0.0002..} We did not apply a cut on Rossby number to the models to mimic a detection threshold, as one might expect if detectability is Ro-dependent. The issue of detection bias is discussed further in \S\ref{subsec:detectionbias}.

The theoretically predicted \teff--\prot distributions of \jvs are shown in relation to the observations in Figure~\ref{fig:models}. Neither model satisfactorily matches the observations, though the WMB model more closely matches the long-period edge of F-type and early G-type stars. The specific WMB prescription of \jvs adopted a critical Rossby number of \rocrit~=~2.08 (using a different \taucz prescription than the one used here), leading to a pileup that is located at larger \prot values (at fixed \teff) when compared to the observations, assuming no \teff offset between the models and the data. Figure~\ref{fig:shifted} shows the same models in relation to the data with constant \teff offsets applied to the data, which are derived in \S\ref{subsec:rossby}. The \teff offsets lead to better agreement between the data and models, although the long-period pileup in the \lamostmcq sample appears to overlay the models only for \teff~$\gtrsim 6000$~K, possibly due to strong \teff-dependent systematics in the LAMOST \teff scale (see Appendix~\ref{app:teff}).

To quantify the degree of agreement between the theoretical models and the \lamostmcq observations we computed the 10th and 90th percentile \prot ranges of the standard and WMB models in overlapping \teff bins, analogous to how the upper and lower boundaries of the observed \prot distribution were found in \S\ref{subsec:rossby}. We computed the $\chi^2$ values between the observed upper edge and the 90th percentile ranges of the standard and WMB models, finding the WMB model is preferred with a $\Delta \chi^2 = [NUMERICAL_RESULT]$. Moreover, the WMB model better reproduces the slope of the observed long-period edge between 5300--6000~K (Figure~\ref{fig:percentiles}). 

While better agreement between the WMB model and observations might be achieved with stalling at a lower \rocrit, it is also possible that there are systematic offsets in the \teff scales between the observations and models used in \jvs, as well as differences in the computation of \taucz. We also note that, while the models were computed using a simulated Kepler stellar population and selection function, the actual observed population and selection function of the \lamostmcq may be slightly different. 

Shifting the LAMOST \teff to higher values would bring the data into better agreement with the models, and in Appendix~\ref{app:teff} we show the LAMOST \teff are $\sim$50--100~K cooler than the other surveys considered here. In turn, it appears that the long-period edge for lower mass stars would be at higher \prot than the models (i.e. the low-mass stars would be rotating more slowly than the model predictions). Such a discrepancy could result from different underlying populations between the models and the \lamostmcq sample, or a different normalization for the magnetic braking law. The models above employ a modified magnetic braking law that is scaled to match the rotation period of the Sun \citep[see equations 1 \& 2 of][]{vanSaders2013}, with a normalization factor of $f_K = 6.6$. A higher normalization factor would cause the low-mass stars to spin down more at fixed age.

Notably, both models fail to reproduce the observed short-period pileup, possibly due to the assumption of solid-body rotation in both models. At early times, Sun-like and low-mass stars are expected to have strong radial differential rotation due to their rapid collapse onto the main-sequence. The core and envelope at these times are thus assumed to be decoupled. However, the core and envelope are expected to couple on timescales of a few tens of million years for Sun-like stars \citep{Denissenkov2010, GalletBouvier2015, Lanzafame2015} or hundreds of million years for low-mass stars \citep{GalletBouvier2015,Lanzafame2015,Somers2016}. When this happens, angular momentum can be transferred from the core to the envelope at a rate comparable to the rate at which angular momentum is lost via magnetized winds. Consequently, so-called ``two-zone'' models \citep{MacGregor1991} spin more rapidly than solid-body rotators at the same age. This hypothesis is discussed further in \S\ref{subsec:shortperiod}.


\begin{figure*}
 \centering 
 \includegraphics[width=0.49\linewidth]{./figures/std-model-cks-shifted.pdf}
 \includegraphics[width=0.49\linewidth]{./figures/wmb-model-cks-shifted.pdf}
 \includegraphics[width=0.49\linewidth]{./figures/std-model-lamost-shifted.pdf}
 \includegraphics[width=0.49\linewidth]{./figures/wmb-model-lamost-shifted.pdf}
 \caption{Same as Figure~\ref{fig:models} with constant \teff offsets applied to the data. Shifts of +111~K and +116~K are applied to the CKS and LAMOST \teff, respectively. The \teff shifts originate from a least-squares fit of a \rocrit~=~\rosun curve (with a \teff offset) to the long-period pileup (as described in \S\ref{subsec:rossby}).}
 \label{fig:shifted}
 \script{shifted.py}
\end{figure*}


\subsection{Comparison with literature surveys}
\label{subsec:asteroseismic}

\hall determined rotation periods for 91 main-sequence, asteroseismic Kepler targets from rotational splitting of asteroseismic oscillation frequencies. We found that the distribution of the asteroseismic sample in the \teff--\prot plane approximately matches the pileup we observe, although the \hall sample appears shifted slightly to either higher \prot or higher \teff values relative to the ridge in the \lamostmcq sample while such an offset is either absent or not as apparent relative to the CKS sample. Such an offset could be due to differing spectroscopic temperature scales between the two studies, differing observational biases, or some combination of effects.

To assess the consistency of the \teff scales between catalogs, we cross-matched the \hall sample with the LAMOST DR5 catalog and the CKS sample. We found a root mean square (RMS) of the residuals between the \hall and LAMOST DR5 \teff measurements of 55~K, with a median offset of 41~K, such that the LAMOST \teff scale is cooler, on average (see Appendix~\ref{app:teff}). Similarly, we found excellent agreement between the \teff scales of the CKS and \hall samples, with a median offset of 29~K (such that the CKS scale is hotter) and an RMS of 41~K. These offsets are modest, and do not account for non-linear systematics which may exist (particularly in the LAMOST \teff).

\masuda inferred the \prot distribution of 144 late-F/early-G dwarfs in the Kepler field from precise stellar radii and spectroscopically determined \vsini. As with the asteroseismic sample, we compared the CKS and \lamostmcq samples with the results of those authors. We find that the long-period pileup we observe appears to overlap with the \masuda data, within the uncertainties of those authors. We therefore consider it likely that the long-period pileup is the same feature, or an extension of the same feature, that was detected in the \hall and \masuda studies.

\begin{figure*}
 \centering
 \includegraphics[width=\linewidth]{./figures/asteroseismic.pdf}
 \caption{Comparison of CKS (left column) and \lamostmcq samples (right column) with the \hall main-sequence asteroseismic sample (top row) and the \masuda sample (bottom row) in the \teff--\prot plane. The black point indicates the Sun. Note, the CKS, LAMOST, and \hall samples derive \teff from distinct pipelines. In the top panels, constant offsets of -29~K and +41~K were added to the CKS and LAMOST \teff, respectively, based on comparisons to those stars with overlap in the H21 sample (see \S~\ref{subsec:asteroseismic} and Appendix~\ref{app:teff}). Using LAMOST \teff, where it exists, for the \hall sample brings that sample into even closer agreement with the long-period pileup in the LAMOST-McQuillan sample.}
 \label{fig:asteroseismic}
 \script{asteroseismic.py}
\end{figure*}

\subsection{Ages of stars on the long-period pileup}
\label{subsec:ages}
The WMB model predicts that hotter stars pile up on the long-period edge at younger ages, producing an age gradient across the edge. In Figure~\ref{fig:ages} we show the \teff-age distributions of stars on the ridge using ages from the CKS \citep{Fulton2018} and SPOCS \citep{Brewer2018} catalogs, where we use the trapezoidal selection described in \S\ref{subsec:rossby} to select stars on the long-period pileup. Both catalogs derive spectroscopic parameters from the CKS spectra, but use different pipelines for both the spectroscopic parameters and the isochrone fitting. 

In both cases, there appears to be an age gradient such that hotter stars are younger on average. However, such a trend is also expected in a sample of main-sequence stars as a natural consequence of the shorter main-sequence lifetimes of hotter, more massive stars. We also find that the dispersion in age is a sensitive function of \teff, with cooler stars on the ridge showing a broader range of ages. This observation could be due to cooler stars populating the ridge for longer periods of time (relative to hotter stars), the lower precision of isochrone ages for cooler stars, or some combination of the two effects.

We determined that 90\% of the stars on the ridge have ages between [NUMERICAL_RESULT]--[NUMERICAL_RESULT]~Gyr (using ages from the CKS catalog), or 2.3--5.9~Gyr (using SPOCS ages). These ranges are consistent with the range of ages observed in the \hall and \masuda samples, as shown in Figure~11 of the latter reference. However, we note that systematic effects in surveys and theoretical models lead to large uncertainties in isochrone ages that are not necessarily represented by the reported age uncertainties. For example, it is curious that, when using SPOCS ages only $\sim$1\% of the stars have ages $<$~2~Gyr and that stars are concentrated at the upper age boundary for a given \teff (Figure~\ref{fig:ages}). In fact, there are only a handful of long-period pileup stars in the CKS sample with ages older than the age of the Sun (using CKS ages), and almost all of the pileup stars would be compatible with an age equal to or less than the Sun's given the large age uncertainties. 

In the WMB model, although wind-driven angular momentum losses cease, stars continue to evolve structurally which results in evolution in the moment of inertia and stellar spin, driven by expansion of the stars away from the main-sequence \citep{vanSaders2019}. Stars reach \rocrit~$\approx$~2 approximately halfway through their main-sequence lifetimes and remain there until the main-sequence turnoff. Thus, higher mass stars with shorter main-sequence lifetimes should show a smaller age spread on the long-period pileup relative to lower mass stars with longer main-sequence lifetimes. Though we have not quantified such an age-gradient, the data suggest that some stars spend several Gyr occupying the ridge with only modest evolution of their spin rates.

We additionally selected stars on the long-period pileup from the \lamostmcq sample by selecting stars with periods within 5\% of the Ro~=~1.3 curve (which traces the center of the highest density contour in Figure~\ref{fig:kde}), 5500~K~$<$~\teff~$<$~6500~K, and 4.1~dex~$<$~\logg~$<$~4.75~dex. While ages for the \lamostkep sample are not available, the broad distribution of these stars in the spectroscopic H-R diagram supports the inference from the CKS sample that the long-period pileup is populated by stars with a broad range of ages (Figure~\ref{fig:ages}). Interestingly, the solar \teff and \logg values appear to be wholly consistent with the distribution of long-period pileup stars. We discuss the Sun in context of the long-period pileup further in \S\ref{subsec:thesun}.

To further assess the evolutionary state of stars on the long-period pileup, we constructed a color-magnitude diagram (CMD) from the Gaia DR2 photometry and parallaxes for the Kepler field, the \mma and \santos rotation period catalogs, the \hall asteroseismic sample, and the CKS long-period pileup stars from this work (Figure~\ref{fig:cmd}). Stars with detected periods from rotational brightness modulations are primarily solar-type and lower-mass dwarfs, with a comparatively small number of subgiants. The \santos catalog contains more stars, in part due to the higher sensitivity to more slowly rotating, evolved stars, relative to \mma. CKS stars on the long-period pileup clearly occupy a well-defined region of the upper main-sequence which overlaps well with the \hall asteroseismic sample.

\subsection{Where do the pileups end?} \label{subsec:extent}
It appears from Figures~\ref{fig:kde} and \ref{fig:models} that the number density of stars on the long-period pileup declines towards cooler \teff, as predicted by the WMB model (see Figure~13 of \jvs). The number density of stars on the short-period pileup similarly declines towards cooler \teff. If the short-period pileup is due to coreâ€“envelope coupling, one might expect an opposite trend of increasing number density toward cooler \teff, since the coreâ€“envelope coupling timescales and hence the ``stalled'' braking phases are longer for lower-mass stars \citep{Curtis2020}. However, the observed \teff--\prot distribution depends sensitively on the selection functions and observational biases inherent to both Kepler and the source of \teff (e.g. LAMOST), which likely explains the observed number density trend. 

While it not clear whether or not these declines are astrophysical in nature, the result of the selection functions or observational biases inherent to Kepler or LAMOST, or some combination of effects, we attempted to characterize the extent of the pileups through the following approach. We found through inspection that constant Rossby curves of Ro=0.5 and Ro=[NUMERICAL_RESULT] (for the short- and long-period pileups, respectively) appear to describe the highest density contours found from Gaussian kernel density estimation of the \lamostmcq sample. In windows of 10~K width we measured the fraction of stars with periods within 1~d of each of the two constant Rossby curves, relative to the total number of stars in that \teff window. We found that the relative fraction of stars on the long-period pileup declines rapidly between 6500~K and 5800~K, by more than half in that temperature range before plateauing at cooler \teff (Figure~\ref{fig:fraction}). The relative fraction of stars on the short-period pileup declines more slowly, and below the temperature of the Sun, the relative fractions of stars on the two pileups are nearly equal. Thus, it is not yet clear if either pileup extends to temperatures cooler than \tsun.

\begin{figure}
 \centering
 \includegraphics[width=\linewidth]{./figures/fraction.pdf}
 \caption{The relative fraction of stars on the long- and short-period pileups, in the \lamostmcq sample, in 10~K windows of \teff (for stars with \logg~$>$4.1 dex).}
 \label{fig:fraction}
 \script{fraction.py}
\end{figure}
